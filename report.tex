% arara: xelatex
% arara: biber
% arara: makeglossaries
% arara: xelatex
% arara: xelatex
\documentclass[paper=A4,DIV=calc]{scrbook}
\usepackage{amsmath}
%% FONTS (fold)
\usepackage{ifxetex}
\ifxetex
	\usepackage[no-math]{fontspec}
	\usepackage[oldstyle,tabular,semibold]{libertine}
	\usepackage[libertine,slantedGreek,liby,bigdelims]{newtxmath}
	\setmonofont[Scale=0.9]{Anonymous Pro}
	\usepackage{polyglossia}
	\setmainlanguage{english}
	\setotherlanguage{swedish}
\else
	\usepackage[utf8]{inputenc}
	\usepackage[T1]{fontenc}
	\usepackage[oldstyle,tabular,semibold]{libertine}
	\usepackage[libertine,slantedGreek,liby,bigdelims]{newtxmath}
	\usepackage[ttdefault,scale=0.9]{AnonymousPro}
	\usepackage[swedish,english]{babel}
\fi
%% (end)
% tikz stuff
\usepackage{tikz}
\usetikzlibrary{calc,arrows,positioning,shapes}
\tikzset{>=stealth,pointer/.style={->,thick,shorten <=2pt,shorten >=2pt}}
% subcaptions
\usepackage{caption,subfig}
\captionsetup[subfigure]{font={it,small},labelfont={bf,small}}
% more packages
\usepackage{chs-msc-thesis}
\usepackage{csquotes}
\usepackage{array}
%\usepackage{tabu}
\usepackage{booktabs}
\usepackage[algoruled,algochapter,linesnumbered]{algorithm2e}
\usepackage{ntheorem,xfrac}
\usepackage{mathtools}
\usepackage[binary-units=true]{siunitx}
\usepackage[authordate,backend=biber,firstinits=true,useprefix=true]{biblatex-chicago} % noibid?
\usepackage[acronym,nomain,nonumberlist,acronymlists={hidden}]{glossaries}
\usepackage{hyperref}
\usepackage{cleveref}

\let\C\undefined
\usepackage[commonsets]{skmath}
\input{fixes.tex}
\input{macros.tex}

\input{acronyms.tex}

\theoremstyle{plain}
\newtheorem{theorem}{Theorem}
\theoremstyle{definition}
\newtheorem{definition}{Definition}
%\newtheorem{example}{Example}

\DontPrintSemicolon
\sisetup{locale=DE,detect-all}

\makeatletter
% equivalent to dashed=false in standard biblatex styles
\AtEveryBibitem{\global\undef\bbx@lasthash}
%% fixes the "strange" (apparently normal) order of names in author list
%\DeclareNameAlias{sortname}{last-first}
% fixes doi formatting
\DeclareFieldFormat*{doi}{\textsc{doi}\addcolon\space\textsc{#1}}
\makeatother
\ExplSyntaxOn
% circumvents lack of italic small-caps by redefining title styles
\titleformat{\section}[block]{
	\vspace*{.25\baselineskip}\centering
	\__unless_usekomafont:n{\large}
	\__maybe_usekomafont:n{section}
}{\thesection}{1ex}{\__maybe_textssc:n{\MakeLowercase{#1}}}[\vspace{-.5\baselineskip}]
%\cs_if_exist_use:NT\addtokomafont{{section}{\sffamily}}
%\cs_if_exist_use:NT\addtokomafont{{subsection}{\sffamily\normalsize}}
%\titleformat{\subsection}[hang]{
%	\__unless_usekomafont:n{\large}
%	\__maybe_usekomafont:n{subsection}
%}{\llap{\thesubsection\hspace{1ex}}}{0pt}{{#1}}[\vspace{-.5\baselineskip}]
%\cs_if_exist_use:NT\addtokomafont{{subsubsection}{\sffamily}}
%\titleformat{\subsubsection}[hang]{
%	\__maybe_usekomafont:n{subsubsection}
%}{\llap{\thesubsubsection\hspace{1ex}}}{0pt}{\textit{#1}}[\vspace{-.5\baselineskip}]
\ExplSyntaxOff

\SetupMetadata{
	% [todo] - make sure all this metadata is correct
	% Required metadata
	%title = {Solving the max-sum problem with the in-the-middle heuristic},
	title = {Evaluating the in-the-middle heuristic in \mbox{Graphical~Model} \mbox{Discrete~Optimization}},
	author = {Simon Sigurdhsson},
	year = {2014},
	subject = {Engineering Mathematics},
	department = {Department of Computer Science and Engineering},
	% [review] - review the keyword list!
	keywords = {Combinatorial optimization, Integer linear programming, Graphical model, Markov random field, Weighted constraint satisfaction problem, Constraint programming, Wedelin heuristic, Max-SAT},
	% [todo] - write abstract!
	abstract = {?},
	% Optional metadata
	%issn = {},
	%subtitle = {},
	%publisher = {},
	series = {2014:?},
	%cover-caption = {Bildtext till framsidebilden},
	%cover-image = {\includegraphics{...}}
}

\addbibresource{references.bib}

\begin{document}
	\frontmatter
	\makefrontmatter

	% [review] - include acknowledgements?
	% \cleardoublepage
	% \section*{Acknowledgements}

	\cleardoublepage
	\tableofcontents
	\cleardoublepage
	\printglossary[type=\acronymtype,]
	
	% [fix] - check grammatical tense, grammatical person, etc. (check writing guide)
	% [fix] - use "I" for first-person
	% [fix] - check overall conformance to writing guide
	% [fix] - spell-check entire report (use aspell?)
	% [fix] - make one last pass re-ordering figures and tables

	\mainmatter

	\chapter{Introduction}
	\input{introduction.tex}
	\input{introduction/background.tex}
	\input{introduction/related.tex}

	% Reset glossaries "first use" for all acronyms after the introduction
	\glsresetall

	\chapter{Theory}
	\input{theory.tex}
	\input{theory/maxsum.tex}
	\input{theory/inthemiddle.tex}

	\chapter{Method}
	\input{method.tex}
	\input{method/implementation.tex}
	\input{method/benchmarking.tex}

	\chapter{Results}
	\input{results.tex}
	\input{results/standard.tex}
	\input{results/improvements.tex}
	\input{results/discussion.tex}

	\chapter{Conclusions}
	\input{conclusions.tex}

	% [todo] - find published variants of unpublished works (incl. strange pubstates)
	% [todo] - check report for the ibidem thing, make sure it doesn't make things strange
	\printbibliography[heading=bibintoc]
	%\printindex
	\backmatter
\end{document}
